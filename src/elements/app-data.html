<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-storage/app-indexeddb-mirror/app-indexeddb-mirror.html">
<link rel="import" href="polymerfire.html">

<dom-module id="app-data">
  <template>
    <firebase-query
      id="users"
      app-name="{$ firebase.name $}"
      path="/userDetails"
      order-by-child="displayName"
      data="{{_firebaseUsers}}">
    </firebase-query>

    <app-indexeddb-mirror
      session="{$ firebase.indexedDbSession $}"
      key="users"
      data="{{_firebaseUsers}}"
      persisted-data="{{app.users}}">
    </app-indexeddb-mirror>

    <firebase-query
      id="organizations"
      app-name="{$ firebase.name $}"
      path="/organizations"
      order-by-key
      data="{{_firebaseOrganizations}}">
    </firebase-query>

    <app-indexeddb-mirror
      session="{$ firebase.indexedDbSession $}"
      key="organizations"
      data="{{_firebaseOrganizations}}"
      persisted-data="{{app.organizations}}">
    </app-indexeddb-mirror>

  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        is: 'app-data',

        properties: {
          app: {
            type: Object,
            notify: true
          }
        },

        ready: function () {
          this.app = this.app || {}; 
	}
    });

  }());
  </script>
</dom-module>
